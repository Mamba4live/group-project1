---
title: "Relation among Glucose , Insulin and BloodPressure"
author: "Yinbo Zhao 520173668"
subtitle: "Project 1"
date: "University of Sydney | MATH1005 | Lab Class 22"
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    self_contained: yes
    theme: flatly
    toc: true
    toc_depth: 3
    toc_float: true
    code_folding: hide
---

<br>

# Executive Summary
- The aim of this report is to ...
- The main discoveries are ...

<br>

# Full Report

## Initial Data Analysis (IDA)

- The data came from ...
- The data is/is not valid because ...
- Possible issues include ...
- Potential stakeholders include...
- Each row represents ...
- Each column represents ...
- The key variables are...

<br>

## Research Question 1: What is the relation between Glucose and BloodPressure

Insert text and analysis. 

```{r}
## read data 
forigin = read.csv("data/diabetes.csv")


##remove value = 0 reasonably
f=data.frame(forigin)
f<-f[which(forigin$Glucose!=0),]
f<-f[which(f$BloodPressure!=0),]
f<-f[which(f$SkinThickness!=0),]
f<-f[which(f$Insulin!=0),]
f<-f[which(f$BMI!=0),]
f<-f[which(f$DiabetesPedigreeFunction!=0),]
f<-f[which(f$Age!=0),]
rownames(f)<-NULL



## show classification of variables
str(f)
glucose = f$Glucose
bp = f$BloodPressure


```
Blood Pressure:
```{r}
## write code here



par(mfrow = c(1,2))
hist(bp)
boxplot(bp,horizontal = T)


```

The mean Value of Blood Pressure
```{r}
mean(bp)
```
The standard deviation of Blood Pressure
```{r}

sd(bp)
```

The median Value of Blood Pressure
```{r}
median(bp)
```

The IQR Value of Blood Pressure
```{r}
IQR(bp)
```

Normal Curve of Blood Pressure:
```{r}
curve(dnorm(x,round(mean(bp),0),round(sd(bp),0)),from=0,to=140,ylab="Density",main="Normal Curve of Blood Pressure")

```


68% people's Blood Pressure is in the range [58, 83]
```{r}
mean(bp)-sd(bp)
mean(bp)+sd(bp)

```
95% people's Blood Pressure is in the range [46, 96]
```{r}
mean(bp)-2*sd(bp)
mean(bp)+2*sd(bp)
```
99.7% people's Blood Pressure is in the range [33, 108]
```{r}
mean(bp)-3*sd(bp)
mean(bp)+3*sd(bp)
```
the rate of people with abnormal Blood Pressure
```{r}
pnorm(90,mean = mean(bp),sd = sd(bp),lower.tail = FALSE)
```

Glucose:

```{r}
## write code here
par(mfrow = c(1,2))
hist(glucose)
boxplot(glucose,horizontal = T)
```

The mean Value of Glucose
```{r}
mean(glucose)
```

The standard deviation of Glucose
```{r}
sd(glucose)
```

The median Value of Glucose
```{r}
median(glucose)
```

The IQR Value of Glucose
```{r}
IQR(glucose)
```
Normal Curve of Glucose:
```{r}
curve(dnorm(x,round(mean(glucose),0),round(sd(glucose),0)),from=0,to=240,ylab="Density",main="Normal Curve of Glucose")

```


68% people's Glucose is in the range [91, 153]
```{r}
mean(glucose)-sd(glucose)
mean(glucose)+sd(glucose)

```
95% people's Glucose is in the range [61, 184]
```{r}
mean(glucose)-2*sd(glucose)
mean(glucose)+2*sd(glucose)
```
99.7% people's Glucose is in the range [30, 215]
```{r}
mean(glucose)-3*sd(glucose)
mean(glucose)+3*sd(glucose)
```


the rate of people with abnormal Glucose
```{r}
pnorm(140 ,mean = mean(glucose),sd = sd(glucose),lower.tail = FALSE)
```

Glucose and BloodPressure

Scatter Plot:
```{r}
plot(glucose, bp, xlab = "Glucose (mg/dL)",ylab = "BP (mm Hg)")

```
correlation coefficient
```{r}
ybar=mean(bp)
y1=bp-mean(bp)
ySD=sd(bp)
ystd=y1/ySD

xbar=mean(glucose)
x1=glucose-mean(glucose)
xSD=sd(glucose)
xstd=x1/xSD

r=mean(ystd*xstd)
r
```
HeatMap:
```{r}
heatmap(table(glucose, bp), Rowv = NA, Colv = NA)
```
Linear model between glucose and BloodPressure:

```{r}
lm(bp~glucose)
```
Thus The equation of the regression line is

      BloodPressure = 60.23 + 0.085 * Glucose
      
      
```{r}
plot(glucose, bp, xlab = "Glucose (mg/dL)",ylab = "BP (mm Hg)")
abline(lm(bp~glucose))

```

Diagram of the Residual
```{r}

l = lm( bp ~ glucose)
plot(glucose, l$residuals,xlab = "Glucose (mg/dL)")
abline(h=0, col = "red")

```




<br>

## Research Question 2: What is the relation between Insulin and Glucose

Insert text and analysis. 

```{r}
## read data 
forigin = read.csv("data/diabetes.csv")


##remove value = 0 reasonably
f=data.frame(forigin)
f<-f[which(forigin$Glucose!=0),]
f<-f[which(f$BloodPressure!=0),]
f<-f[which(f$SkinThickness!=0),]
f<-f[which(f$Insulin!=0),]
f<-f[which(f$BMI!=0),]
f<-f[which(f$DiabetesPedigreeFunction!=0),]
f<-f[which(f$Age!=0),]
rownames(f)<-NULL



## show classification of variables
str(f)
ins = f$Insulin
glucose = f$Glucose


```
Insulin:
```{r}
## write code here



par(mfrow = c(1,2))
hist(ins)
boxplot(ins,horizontal = T)


```

The mean Value of Insulin
```{r}
mean(ins)
```
The standard deviation of Insulin
```{r}

sd(ins)
```

The median Value of Insulin
```{r}
median(ins)
```

The IQR Value of Insulin
```{r}
IQR(ins)
```


Glucose:

```{r}
## write code here
par(mfrow = c(1,2))
hist(glucose)
boxplot(glucose,horizontal = T)
```

The mean Value of Glucose
```{r}
mean(glucose)
```

The standard deviation of Glucose
```{r}
sd(glucose)
```

The median Value of Glucose
```{r}
median(glucose)
```

The IQR Value of Glucose
```{r}
IQR(glucose)
```
Normal Curve of Glucose:
```{r}
curve(dnorm(x,round(mean(glucose),0),round(sd(glucose),0)),from=0,to=240,ylab="Density",main="Normal Curve of Glucose")

```
68% people's Glucose is in the range [91, 153]
```{r}
mean(glucose)-sd(glucose)
mean(glucose)+sd(glucose)

```
95% people's Glucose is in the range [61, 184]
```{r}
mean(glucose)-2*sd(glucose)
mean(glucose)+2*sd(glucose)
```
99.7% people's Glucose is in the range [30, 215]
```{r}
mean(glucose)-3*sd(glucose)
mean(glucose)+3*sd(glucose)
```

the rate of people with abnormal Glucose
```{r}
pnorm(140 ,mean = mean(glucose),sd = sd(glucose),lower.tail = FALSE)
```


Insulin and Glucose

Scatter Plot:
```{r}
plot(glucose,ins)

```
correlation coefficient
```{r}
xbar=mean(glucose)
x1=glucose-mean(glucose)
xSD=sd(glucose)
xstd=x1/xSD

ybar=mean(ins)
y1=ins-mean(ins)
ySD=sd(ins)
ystd=y1/ySD

r=mean(xstd*ystd)
r
```
HeatMap:
```{r}
heatmap(table(ins,glucose), Rowv = NA, Colv = NA)
```
Linear model between ins and glucose:

```{r}
lm(ins~glucose)
```
Thus The equation of the regression line is

      Glucose = -118.41 + 2.24 * BloodPressure
      
      
```{r}
plot(glucose,ins)
abline(lm(ins~glucose))

```

Diagram of the Residual
```{r}

l = lm( ins ~ glucose)
plot(glucose, l$residuals)
abline(h=0, col = "red")

```


<br>

# References

Put references here in APA format.
